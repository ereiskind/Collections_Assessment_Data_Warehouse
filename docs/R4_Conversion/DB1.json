[
    {
        "op": "core/column-rename",
        "oldColumnName": "Database",
        "newColumnName": "Resource_Name",
        "description": "Rename column ``Database`` to ``Resource_Name``"
    },
    {
        "op": "core/column-rename",
        "oldColumnName": "User Activity",
        "newColumnName": "Metric_Type",
        "description": "Rename column ``User Activity`` to ``Metric_Type``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "Resource_Name",
        "expression": "grel:value.unicode().join(\",\")",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change characters in ``Resource_Name`` to their Unicode code points"
    },
    {
        "op": "core/transpose-columns-into-rows",
        "startColumnName": "Reporting Period Total",
        "columnCount": -1,
        "ignoreBlankCells": false,
        "fillDown": true,
        "separator": null,
        "keyColumnName": "R4_Month",
        "valueColumnName": "R4_Count",
        "description": "Pivot all columns with counts into two columns, one named ``R4_Month`` with the column name/date and the other named ``R4_Count`` with the data value/count"
    },
    {
        "op": "core/row-removal",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "R4_Month",
                    "expression": "value",
                    "columnName": "R4_Month",
                    "invert": false,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "Reporting Period Total",
                                "l": "Reporting Period Total"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "row-based"
        },
        "description": "Remove rows with a ``R4_Month`` value of `Reporting Period Total`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "R4_Month",
        "expression": "grel:if(value.contains(/E[D|S]T/),value.replace(\"EDT\",\"EST\").toDate(),(substring(value,0,4)+\"1-\"+substring(value,4)).toDate())",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change the values in column ``R4_Month`` to date data type"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "baseColumnName": "Metric_Type",
        "expression": "grel:\"Database\"",
        "onError": "set-to-blank",
        "newColumnName": "Data_Type",
        "columnInsertIndex": 4,
        "description": "Creat column ``Data_Type`` containing value `Database`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "Resource_Name",
        "expression": "grel:if(isBlank(value),\"NULL\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values to `NULL` in column ``Resource_Name``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "row-based"
        },
        "columnName": "Publisher",
        "expression": "grel:if(isBlank(value),\"NULL\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values to `NULL` in column ``Publisher``"
    }
]